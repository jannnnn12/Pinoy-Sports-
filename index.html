<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arnis Fighting Game</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #8B4513, #D2691E);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Courier New', monospace;
        }
        
        .game-container {
            background: #2F4F4F;
            border: 5px solid #8B4513;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        
        canvas {
            background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 50%, #8B4513 100%);
            border: 3px solid #654321;
            display: block;
        }
        
        .hud {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: white;
            font-weight: bold;
        }
        
        .health-bar {
            width: 200px;
            height: 20px;
            background: #333;
            border: 2px solid #fff;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff0000, #ffff00, #00ff00);
            transition: width 0.3s ease;
        }
        
        .controls {
            color: white;
            font-size: 12px;
            margin-top: 10px;
            text-align: center;
        }
        
        .game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            font-size: 24px;
            display: none;
        }
        
        button {
            background: #8B4513;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 15px;
            font-size: 16px;
        }
        
        button:hover {
            background: #A0522D;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="hud">
            <div>
                <div>Player 1 (WASD + F/G)</div>
                <div class="health-bar">
                    <div class="health-fill" id="health1" style="width: 100%"></div>
                </div>
            </div>
            <div style="text-align: center; color: #FFD700; font-size: 20px;">
                ARNIS MASTERS
            </div>
            <div>
                <div>Player 2 (Arrow Keys + N/M)</div>
                <div class="health-bar">
                    <div class="health-fill" id="health2" style="width: 100%"></div>
                </div>
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="400"></canvas>
        
        <div class="controls">
            <strong>Player 1:</strong> WASD to move, F = Strike, G = Block | 
            <strong>Player 2:</strong> Arrow Keys to move, N = Strike, M = Block
        </div>
        
        <div class="game-over" id="gameOver">
            <div id="winner"></div>
            <button onclick="restartGame()">Play Again</button>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Game state
        let gameRunning = true;
        const keys = {};
        
        // Fighter class
        class Fighter {
            constructor(x, y, controls, color, name) {
                this.x = x;
                this.y = y;
                this.width = 40;
                this.height = 60;
                this.velocityX = 0;
                this.velocityY = 0;
                this.speed = 3;
                this.jumpPower = 15;
                this.onGround = false;
                this.health = 100;
                this.maxHealth = 100;
                this.facing = 1; // 1 = right, -1 = left
                this.color = color;
                this.name = name;
                
                // Combat properties
                this.isAttacking = false;
                this.isBlocking = false;
                this.attackCooldown = 0;
                this.blockCooldown = 0;
                this.attackRange = 80;
                this.attackDamage = 15;
                this.comboCount = 0;
                this.comboTimer = 0;
                
                // Stick properties
                this.stickAngle = 0;
                this.stickLength = 50;
                
                // Animation
                this.animationFrame = 0;
                this.animationSpeed = 0.2;
                
                this.controls = controls;
            }
            
            update() {
                this.handleInput();
                this.updatePhysics();
                this.updateCombat();
                this.updateAnimation();
                this.constrainToCanvas();
            }
            
            handleInput() {
                if (!gameRunning) return;
                
                // Movement
                this.velocityX = 0;
                
                if (keys[this.controls.left]) {
                    this.velocityX = -this.speed;
                    this.facing = -1;
                }
                if (keys[this.controls.right]) {
                    this.velocityX = this.speed;
                    this.facing = 1;
                }
                
                // Jumping
                if (keys[this.controls.up] && this.onGround) {
                    this.velocityY = -this.jumpPower;
                    this.onGround = false;
                }
                
                // Attack
                if (keys[this.controls.attack] && this.attackCooldown <= 0) {
                    this.attack();
                }
                
                // Block
                this.isBlocking = keys[this.controls.block] && this.blockCooldown <= 0;
            }
            
            updatePhysics() {
                // Apply gravity
                this.velocityY += 0.8;
                
                // Update position
                this.x += this.velocityX;
                this.y += this.velocityY;
                
                // Ground collision
                const groundY = canvas.height - 80;
                if (this.y + this.height >= groundY) {
                    this.y = groundY - this.height;
                    this.velocityY = 0;
                    this.onGround = true;
                }
            }
            
            updateCombat() {
                // Update cooldowns
                if (this.attackCooldown > 0) this.attackCooldown--;
                if (this.blockCooldown > 0) this.blockCooldown--;
                
                // Update combo timer
                if (this.comboTimer > 0) {
                    this.comboTimer--;
                } else {
                    this.comboCount = 0;
                }
                
                // Reset attack state
                if (this.attackCooldown <= 10) {
                    this.isAttacking = false;
                }
            }
            
            updateAnimation() {
                this.animationFrame += this.animationSpeed;
                if (this.animationFrame >= 4) this.animationFrame = 0;
                
                // Update stick angle based on state
                if (this.isAttacking) {
                    this.stickAngle = Math.sin(this.attackCooldown * 0.5) * 0.8;
                } else if (this.isBlocking) {
                    this.stickAngle = -0.3 * this.facing;
                } else {
                    this.stickAngle = 0.1 * Math.sin(this.animationFrame);
                }
            }
            
            attack() {
                this.isAttacking = true;
                this.attackCooldown = 20;
                this.comboCount++;
                this.comboTimer = 60; // Combo window
                
                // Different attack patterns based on combo
                let damage = this.attackDamage;
                let knockback = 5;
                
                if (this.comboCount === 2) {
                    damage *= 1.2;
                    knockback *= 1.5;
                } else if (this.comboCount >= 3) {
                    damage *= 1.5;
                    knockback *= 2;
                    this.comboCount = 0; // Reset after special attack
                }
                
                // Check for hit
                const opponent = this.name === 'Player 1' ? fighter2 : fighter1;
                const distance = Math.abs(this.x - opponent.x);
                const yDistance = Math.abs(this.y - opponent.y);
                
                if (distance < this.attackRange && yDistance < 50) {
                    this.hit(opponent, damage, knockback);
                }
            }
            
            hit(opponent, damage, knockback) {
                if (opponent.isBlocking) {
                    // Reduced damage when blocking
                    damage *= 0.3;
                    knockback *= 0.5;
                    opponent.blockCooldown = 30; // Block fatigue
                }
                
                // Apply damage
                opponent.health -= damage;
                opponent.health = Math.max(0, opponent.health);
                
                // Apply knockback
                const direction = opponent.x > this.x ? 1 : -1;
                opponent.velocityX = direction * knockback;
                
                // Check for game over
                if (opponent.health <= 0 && gameRunning) {
                    endGame(this.name + ' Wins!');
                }
                
                // Update health bar
                updateHealthBar();
            }
            
            constrainToCanvas() {
                if (this.x < 0) this.x = 0;
                if (this.x + this.width > canvas.width) this.x = canvas.width - this.width;
            }
            
            draw() {
                ctx.save();
                
                // Draw shadow
                ctx.fillStyle = 'rgba(0,0,0,0.3)';
                ctx.fillRect(this.x + 5, canvas.height - 75, this.width, 10);
                
                // Draw fighter body
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.y, this.width, this.height);
                
                // Draw head
                ctx.fillStyle = '#FFDBAC';
                ctx.beginPath();
                ctx.arc(this.x + this.width/2, this.y + 15, 12, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw uniform details
                ctx.fillStyle = '#FFFFFF';
                ctx.fillRect(this.x + 5, this.y + 25, this.width - 10, 3);
                
                // Draw arms
                ctx.strokeStyle = '#FFDBAC';
                ctx.lineWidth = 8;
                ctx.beginPath();
                
                // Main arm holding stick
                const armX = this.x + this.width/2;
                const armY = this.y + 30;
                const armEndX = armX + Math.cos(this.stickAngle) * 25 * this.facing;
                const armEndY = armY + Math.sin(this.stickAngle) * 25;
                
                ctx.moveTo(armX, armY);
                ctx.lineTo(armEndX, armEndY);
                ctx.stroke();
                
                // Draw Arnis stick (rattan)
                ctx.strokeStyle = this.isAttacking ? '#FF6B35' : '#8B4513';
                ctx.lineWidth = 4;
                ctx.beginPath();
                
                const stickEndX = armEndX + Math.cos(this.stickAngle) * this.stickLength * this.facing;
                const stickEndY = armEndY + Math.sin(this.stickAngle) * this.stickLength;
                
                ctx.moveTo(armEndX, armEndY);
                ctx.lineTo(stickEndX, stickEndY);
                ctx.stroke();
                
                // Draw stick tip accent
                ctx.fillStyle = '#654321';
                ctx.beginPath();
                ctx.arc(stickEndX, stickEndY, 3, 0, Math.PI * 2);
                ctx.fill();
                
                // Draw legs
                ctx.strokeStyle = this.color;
                ctx.lineWidth = 12;
                ctx.beginPath();
                ctx.moveTo(this.x + 10, this.y + this.height);
                ctx.lineTo(this.x + 10, this.y + this.height + 15);
                ctx.moveTo(this.x + this.width - 10, this.y + this.height);
                ctx.lineTo(this.x + this.width - 10, this.y + this.height + 15);
                ctx.stroke();
                
                // Draw blocking indicator
                if (this.isBlocking) {
                    ctx.strokeStyle = '#00BFFF';
                    ctx.lineWidth = 3;
                    ctx.setLineDash([5, 5]);
                    ctx.strokeRect(this.x - 5, this.y - 5, this.width + 10, this.height + 10);
                    ctx.setLineDash([]);
                }
                
                // Draw combo indicator
                if (this.comboCount > 1) {
                    ctx.fillStyle = '#FFD700';
                    ctx.font = '16px Arial';
                    ctx.fillText(`${this.comboCount}x COMBO!`, this.x - 10, this.y - 20);
                }
                
                // Draw name
                ctx.fillStyle = 'white';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(this.name, this.x + this.width/2, this.y - 10);
                
                ctx.restore();
            }
        }
        
        // Initialize fighters
        const fighter1 = new Fighter(100, 200, {
            left: 'KeyA',
            right: 'KeyD',
            up: 'KeyW',
            down: 'KeyS',
            attack: 'KeyF',
            block: 'KeyG'
        }, '#1E90FF', 'Player 1');
        
        const fighter2 = new Fighter(600, 200, {
            left: 'ArrowLeft',
            right: 'ArrowRight',
            up: 'ArrowUp',
            down: 'ArrowDown',
            attack: 'KeyN',
            block: 'KeyM'
        }, '#DC143C', 'Player 2');
        
        // Input handling
        window.addEventListener('keydown', (e) => {
            keys[e.code] = true;
        });
        
        window.addEventListener('keyup', (e) => {
            keys[e.code] = false;
        });
        
        // Game functions
        function drawBackground() {
            // Sky and ground already set by CSS gradient
            
            // Draw traditional Filipino elements
            ctx.fillStyle = '#8B4513';
            for (let i = 0; i < 5; i++) {
                ctx.fillRect(i * 160 + 50, canvas.height - 80, 60, 80);
            }
            
            // Draw bamboo poles in background
            ctx.strokeStyle = '#228B22';
            ctx.lineWidth = 8;
            for (let i = 0; i < 6; i++) {
                ctx.beginPath();
                ctx.moveTo(i * 140 + 70, canvas.height - 200);
                ctx.lineTo(i * 140 + 70, canvas.height - 80);
                ctx.stroke();
            }
            
            // Draw ground line
            ctx.strokeStyle = '#654321';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(0, canvas.height - 80);
            ctx.lineTo(canvas.width, canvas.height - 80);
            ctx.stroke();
        }
        
        function updateHealthBar() {
            document.getElementById('health1').style.width = (fighter1.health / fighter1.maxHealth * 100) + '%';
            document.getElementById('health2').style.width = (fighter2.health / fighter2.maxHealth * 100) + '%';
        }
        
        function endGame(winner) {
            gameRunning = false;
            document.getElementById('winner').textContent = winner;
            document.getElementById('gameOver').style.display = 'block';
        }
        
        function restartGame() {
            gameRunning = true;
            fighter1.health = fighter1.maxHealth;
            fighter2.health = fighter2.maxHealth;
            fighter1.x = 100;
            fighter2.x = 600;
            fighter1.y = 200;
            fighter2.y = 200;
            fighter1.velocityX = 0;
            fighter1.velocityY = 0;
            fighter2.velocityX = 0;
            fighter2.velocityY = 0;
            updateHealthBar();
            document.getElementById('gameOver').style.display = 'none';
        }
        
        // Game loop
        function gameLoop() {
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw background
            drawBackground();
            
            if (gameRunning) {
                // Update fighters
                fighter1.update();
                fighter2.update();
            }
            
            // Draw fighters
            fighter1.draw();
            fighter2.draw();
            
            requestAnimationFrame(gameLoop);
        }
        
        // Start game
        updateHealthBar();
        gameLoop();
        
        // Prevent context menu on right click
        canvas.addEventListener('contextmenu', e => e.preventDefault());
    </script>
</body>
</html>
